{
    "sourceFile": "client-app/src/custom/file.extensions.ts",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1627519336535,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1627519336535,
            "name": "Commit-0",
            "content": "import { Inject, Injectable } from '@angular/core';\r\nimport { DOCUMENT_REF, WINDOW_REF } from '@core/services/common.settings';\r\n\r\n@Injectable()\r\nexport class FileExtensions {\r\n\r\n  constructor(@Inject(WINDOW_REF) private winRef: any, @Inject(DOCUMENT_REF) private documentRef: any) { }\r\n\r\n  openFile(response: Blob): void {\r\n    const fileURL = URL.createObjectURL(response);\r\n    this.winRef.open(fileURL);\r\n  }\r\n\r\n  downloadFile(response: Blob, fileName: string): void {\r\n    if (this.isMicrosoftBrowser()) {\r\n      this.winRef.navigator.msSaveBlob(response, fileName);\r\n    } else {\r\n      this.createDownloadLink(response, fileName);\r\n    }\r\n  }\r\n  private isMicrosoftBrowser(): boolean {\r\n    const ieEDGE = this.winRef.navigator.userAgent.match(/Edge/g);\r\n    const ie = this.winRef.navigator.userAgent.match(/.NET/g); // IE 11+\r\n    const oldIE = this.winRef.navigator.userAgent.match(/MSIE/g);\r\n    return ie || oldIE || ieEDGE;\r\n  }\r\n  private createDownloadLink(response: Blob, fileName: string): void {\r\n    const link = this.documentRef.createElement('a');\r\n    if (link) {\r\n      link.href = this.winRef.URL.createObjectURL(response);\r\n      link.download = fileName;\r\n      this.documentRef.body.appendChild(link);\r\n      link.click();\r\n      this.winRef.setTimeout(() => {\r\n        this.documentRef.body.removeChild(link);\r\n      }, 1000);\r\n    }\r\n  }\r\n\r\n}\r\n"
        }
    ]
}